name: auth
testcases:
- name: unauthenticated deploy
  steps:
  - script: "{{.owh}} deploy"
    type: exec
    assertions:
    - result.code ShouldEqual 1
    - "result.systemout ShouldContainSubstring Please run: owh login first"
    - result.systemerr ShouldEqual ""

- name: unauthenticated deploy in CI
  steps:
  - script: "CI=1 {{.owh}} deploy"
    type: exec
    assertions:
    - result.code ShouldEqual 1
    - "result.systemout ShouldContainSubstring To use owh in automation, set the OWH_CONSUMER_KEY environment variable."
    - result.systemerr ShouldEqual ""
